INCLUDE(CMakeForceCompiler)

SET(CMAKE_SYSTEM_NAME Generic-XBOXONE)

IF(NOT ${CMAKE_VS150PATH})
	STRING(REGEX REPLACE "\\\\" "/" VS150CT_DIR ${CMAKE_VS150PATH})
	
	FILE(GLOB_RECURSE CL_PATHS LIST_DIRECTORIES false ${VS150CT_DIR}/VC/Tools/MSVC/*.exe)
	FOREACH(CL_TEMP_PATH ${CL_PATHS})
		IF(CL_TEMP_PATH MATCHES "Hostx64/x64/cl.exe")			
			SET(CL_PATH_FOUND ${CL_TEMP_PATH})
		ENDIF()
	ENDFOREACH()
	
	SET(XBOXONE_MSVC_VERSION 141)

	MESSAGE("Found the compiler: ${CL_PATH_FOUND}")

	CMAKE_FORCE_C_COMPILER(${CL_PATH_FOUND}  MSVC)	

	SET(CMAKE_C_COMPILER_TARGET Durango)

	SET(CMAKE_C_LINKER_SUPPORTS_PDB ON)

	CMAKE_FORCE_CXX_COMPILER(${CL_PATH_FOUND} MSVC)

	SET(CMAKE_CXX_COMPILER_TARGET Durango)

	SET(CMAKE_CXX_LINKER_SUPPORTS_PDB ON)
ELSE()
	MESSAGE("Visual Studio 2017 path not found!")
ENDIF()